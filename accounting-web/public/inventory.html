<!doctype html>
<html lang="ar" dir="rtl">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£ØµÙ†Ø§Ù</title>
<style>
body{font-family:system-ui;margin:24px} input,button{padding:10px;border-radius:10px;border:1px solid #ddd}
.row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:12px}
table{width:100%;border-collapse:collapse;margin-top:12px} th,td{border:1px solid #eee;padding:8px}
a{color:#111}
</style>
</head>
<body>
  <a href="/">â¬… Ø±Ø¬ÙˆØ¹</a>
  <h2>ğŸ“¦ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø£ØµÙ†Ø§Ù</h2>

  <h3>1) Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù</h3>
  <div class="row">
    <input id="sku" placeholder="Ø±Ù‚Ù… Ø§Ù„ØµÙ†Ù SKU" />
    <input id="name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" />
    <input id="price" placeholder="Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹" type="number" step="0.001" />
    <input id="unit" placeholder="Ø§Ù„ÙˆØ­Ø¯Ø© (Ø­Ø¨Ø©/ÙƒØ±ØªÙˆÙ†)" />
    <button id="addProduct">Ø¥Ø¶Ø§ÙØ©</button>
  </div>

  <h3>2) Ø¥Ø¶Ø§ÙØ© ÙƒÙ…ÙŠØ© ÙˆØ§Ø±Ø¯Ø©</h3>
  <div class="row">
    <input id="q" placeholder="Ø¨Ø­Ø« (SKU Ø£Ùˆ Ø§Ø³Ù…)" />
    <button id="search">Ø¨Ø­Ø«</button>
  </div>
  <div class="row">
    <input id="productId" placeholder="ID Ø§Ù„Ù…Ù†ØªØ¬ (Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„)" type="number"/>
    <input id="qty" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„ÙˆØ§Ø±Ø¯Ø©" type="number" step="0.001"/>
    <input id="note" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø© (ÙØ§ØªÙˆØ±Ø©/Ù…ÙˆØ±Ø¯)" />
    <button id="stockIn">ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ø±Ø¯</button>
  </div>

  <table>
    <thead><tr><th>ID</th><th>SKU</th><th>Ø§Ù„Ø§Ø³Ù…</th><th>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</th><th>Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ</th></tr></thead>
    <tbody id="tbl"></tbody>
  </table>

<script type="module">
import { api, qs } from "./app.js";

async function load(q=""){
  const data = await api("/api/products?q="+encodeURIComponent(q));
  qs("#tbl").innerHTML = data.map(p => `
    <tr>
      <td>${p.id}</td><td>${p.sku}</td><td>${p.name}</td><td>${p.sale_price}</td><td>${p.stock}</td>
    </tr>`).join("");
}

qs("#addProduct").onclick = async ()=>{
  await api("/api/products","POST",{
    sku: qs("#sku").value, name: qs("#name").value,
    sale_price: Number(qs("#price").value||0),
    unit: qs("#unit").value||"Ø­Ø¨Ø©"
  });
  await load();
  alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù");
};

qs("#search").onclick = ()=> load(qs("#q").value);

qs("#stockIn").onclick = async ()=>{
  const product_id = Number(qs("#productId").value);
  const qty = Number(qs("#qty").value);
  await api("/api/stock/in","POST",{ product_id, qty, note: qs("#note").value });
  await load();
  alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙˆØ§Ø±Ø¯");
};

load();
</script>
</body>
</html>
